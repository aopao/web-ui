<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>web-ui</title>
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta http-equiv="Access-Control-Allow-Origin" content="*">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=no">
	<link rel="icon" href="favicon.png">
	<link rel="stylesheet" href="./assets/plugins/iconfont/iconfont.css">
	<link rel="stylesheet" href="./layui/css/layui.css">
	<link rel="stylesheet" href="./assets/css/login.css">
</head>
<body>

<!--登录页-->
<div class="login-container">
	<!--logo-->
	<div class="login-logo">
		<img class="login-logo-green" src="./assets/img/login-logo1.png" alt="logo">
		<img class="login-logo-red" src="./assets/img/login-logo2.png" alt="logo">
		<img class="login-logo-blue" src="./assets/img/login-logo1.png" alt="logo">
	</div>
	<!--logo-->
	<!--样式切换-->
	<div class="login-theme">
		<a href="javascript:;" class="login-theme-green" lay-title="护眼绿">Green</a>&nbsp;&nbsp;/&nbsp;&nbsp;
		<a href="javascript:;" class="login-theme-red" lay-title="党建红">Red</a>&nbsp;&nbsp;/&nbsp;&nbsp;
		<a href="javascript:;" class="login-theme-blue" lay-title="科技蓝">Blue</a>
	</div>
	<!--样式切换-->
	<!--登录表单-->
	<form class="login-form layui-form" lay-filter="login-form">
		<div class="login-form-pic"></div>
		<div class="login-form-content">
			<div class="login-form-title"></div>
			<!--用户名-->
			<div class="layui-form-item login-form-item">
				<label class="layui-form-label"><i class="iconfont icon-user"></i></label>
				<div class="layui-input-block">
					<input type="text" name="username" lay-verify="username" autocomplete="off" placeholder="请输入用户名" class="layui-input">
				</div>
			</div>
			<!--用户名-->
			<!--密码-->
			<div class="layui-form-item login-form-item">
				<label class="layui-form-label"><i class="iconfont icon-password"></i></label>
				<div class="layui-input-block">
					<input type="password" name="password" lay-verify="password" placeholder="请输入密码" autocomplete="off" class="layui-input">
				</div>
			</div>
			<!--密码-->
			<!--记住密码-->
			<div class="layui-form-item login-checkbox-wrapper">
				<input type="checkbox" name="remember" lay-skin="primary" title="记住密码">
			</div>
			<!--记住密码-->
			<!--登录按钮-->
			<div class="layui-form-item">
				<button class="layui-btn layui-btn-fluid" lay-submit lay-filter="login">登&nbsp;&nbsp;录</button>
			</div>
			<!--登录按钮-->
		</div>
	</form>
	<!--登录表单-->
	<!--copyright-->
	<div class="login-risen"></div>
	<!--copyright-->
</div>
<!--登录页-->

<script type="text/javascript" src="./layui/layui.js"></script>
<script>
	// 表单登录
	layui.use(['form', 'layer', 'jquery'], function () {
		var form = layui.form,
			layer = layui.layer;
			$ = layui.jquery;

		// 主题
		var $container = $('.login-container');
		var theme = window.sessionStorage.getItem('skin') || 'green';
		$container.removeClass().addClass('login-container '+theme);

		$('.login-theme').on('click', 'a', function () {
			var theme = this.getAttribute('class').replace('login-theme-','') || 'green';
			var title = this.getAttribute('lay-title') || '绿色';
			$container.removeClass().addClass('login-container '+theme);
            window.sessionStorage.setItem("skin",theme);
            window.sessionStorage.setItem("skinValue",title);
		});

        // 验证规则
        form.verify({
            username: function(value, item){ //value：表单的值、item：表单的DOM对象
                if(!new RegExp("^[a-zA-Z0-9_\u4e00-\u9fa5\\s·]+$").test(value)){
                    return '用户名不能有特殊字符';
                }
                if(/(^\_)|(\__)|(\_+$)/.test(value)){
                    return '用户名首尾不能出现下划线\'_\'';
                }
                if(/^\d+\d+\d$/.test(value)){
                    return '用户名不能全为数字';
                }
            }
            ,password: [
                /^[\S]{6,12}$/
                ,'密码必须6到12位，且不能出现空格'
            ]
        });

        // 监听验证
		var status = function() {
		    var status = 'layui-form-danger';
		    if($(this).hasClass(status)) {
		        $(this).closest('.login-form-item').addClass('login-form-danger');
			} else {
                $(this).closest('.login-form-item').removeClass('login-form-danger');
			}
		}
		$('.layui-form').on('blur', '.layui-input', status);

		// 获取保存的密码
        var cookies = JSON.parse(window.localStorage.getItem('loginData'));
        if(cookies) {
            form.val("login-form", cookies)
		}

        // 表单提交
        form.on('submit(login)', function(data) {
			var formObj = data.field;
			// 获取表单数据
            layer.msg(JSON.stringify(formObj));
            // 记住密码
            if(formObj.remember == 'on') {
                window.localStorage.setItem('loginData',JSON.stringify(formObj));
            } else {
                window.localStorage.setItem('loginData',null);
			}
            // 延时跳转到首页
            if(true) {
                setTimeout(function () {
                    window.location.href = 'main.html';
                }, 2000)
            };
            return false;
        });

    });
</script>
</body>
</html>